<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ShopSmart AI - Smart Shopping for India</title>
    <meta name="description" content="AI-powered product recommendations from D2C brands. Find best deals in India!">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#eef2ff',
                            100: '#e0e7ff',
                            500: '#6366f1',
                            600: '#4f46e5',
                            700: '#4338ca',
                        }
                    }
                }
            }
        }
    </script>
    <style>
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .animate-fade-in-up {
            animation: fadeInUp 0.6s ease-out forwards;
        }
        
        .animate-spin {
            animation: spin 1s linear infinite;
        }
        
        .animate-pulse {
            animation: pulse 2s infinite;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-gray-50 to-gray-100 min-h-screen">
    
    <!-- Header -->
    <header class="bg-white/80 backdrop-blur-md border-b border-gray-200 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-primary-500 to-primary-600 rounded-xl flex items-center justify-center">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <circle cx="9" cy="21" r="1"></circle>
                            <circle cx="20" cy="21" r="1"></circle>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                        </svg>
                    </div>
                    <span class="text-xl font-bold text-gray-900">ShopSmart AI</span>
                </div>
                <div class="flex items-center gap-2 px-4 py-2 bg-blue-50 border border-blue-200 rounded-lg">
                    <svg class="w-4 h-4 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <circle cx="12" cy="12" r="10" stroke-width="2"></circle>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 16v-4"></path>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8h.01"></path>
                    </svg>
                    <span class="text-sm font-medium text-blue-700">Demo Mode - Mock Data</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Hero -->
    <section class="bg-gradient-to-r from-primary-600 to-primary-700 text-white py-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h1 class="text-4xl sm:text-5xl lg:text-6xl font-bold mb-6">
                Smart Shopping for India<br>
                <span class="bg-gradient-to-r from-yellow-300 to-orange-400 bg-clip-text text-transparent"></span>
            </h1>
            <p class="text-lg sm:text-xl text-primary-100 max-w-3xl mx-auto leading-relaxed">
                Get AI-powered product recommendations with price comparison across D2C brands.
                Find the best deals in India instantly!
            </p>
        </div>
    </section>

    <!-- Main App -->
    <section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <div class="grid lg:grid-cols-2 gap-8">
            
            <!-- Input Panel -->
            <div class="bg-white rounded-2xl shadow-xl border border-gray-200 p-6 sm:p-8 h-fit">
                <div class="mb-8">
                    <h2 class="text-2xl font-bold text-gray-900 mb-2">What are you looking for?</h2>
                    <p class="text-gray-600">Describe what you need in natural language</p>
                </div>

                <form id="recommendationForm" class="space-y-6">
                    <!-- Query Input -->
                    <div>
                        <label class="flex items-center gap-2 text-sm font-semibold text-gray-700 mb-2">
                            <svg class="w-5 h-5 text-primary-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                            </svg>
                            Tell us what you're shopping for
                        </label>
                        <textarea
                            id="productQuery"
                            rows="4"
                            class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-primary-500 focus:ring-4 focus:ring-primary-500/10 outline-none transition-all resize-none text-gray-900 placeholder-gray-400"
                            placeholder="Example: I need wireless earbuds for workouts, budget around â‚¹2000-3000, good battery life, sweat-resistant..."
                            required
                        ></textarea>
                    </div>

                    <!-- Category and Budget -->
                    <div class="grid sm:grid-cols-2 gap-4">
                        <div>
                            <label class="flex items-center gap-2 text-sm font-semibold text-gray-700 mb-2">
                                <svg class="w-5 h-5 text-primary-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <rect x="3" y="3" width="7" height="7"></rect>
                                    <rect x="14" y="3" width="7" height="7"></rect>
                                    <rect x="14" y="14" width="7" height="7"></rect>
                                    <rect x="3" y="14" width="7" height="7"></rect>
                                </svg>
                                Category
                            </label>
                            <select id="category" class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-primary-500 focus:ring-4 focus:ring-primary-500/10 outline-none transition-all bg-white text-gray-900">
                                <option value="electronics">Electronics</option>
                                <option value="fashion">Fashion & Apparel</option>
                                <option value="home">Home & Kitchen</option>
                                <option value="sports">Sports & Outdoors</option>
                                <option value="beauty">Beauty & Personal Care</option>
                                <option value="books">Books & Media</option>
                            </select>
                        </div>

                        <div>
                            <label class="flex items-center gap-2 text-sm font-semibold text-gray-700 mb-2">
                                <svg class="w-5 h-5 text-primary-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <line x1="12" y1="1" x2="12" y2="23" stroke-width="2"></line>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                                </svg>
                                Budget Range
                            </label>
                            <select id="budget" class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-primary-500 focus:ring-4 focus:ring-primary-500/10 outline-none transition-all bg-white text-gray-900">
                                <option value="budget">Budget (â‚¹0-â‚¹3,000)</option>
                                <option value="mid" selected>Mid-range (â‚¹3,000-â‚¹15,000)</option>
                                <option value="premium">Premium (â‚¹15,000-â‚¹40,000)</option>
                                <option value="luxury">Luxury (â‚¹40,000+)</option>
                            </select>
                        </div>
                    </div>

                    <!-- Preferences -->
                    <div>
                        <label class="flex items-center gap-2 text-sm font-semibold text-gray-700 mb-3">
                            <svg class="w-5 h-5 text-primary-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <polyline points="20 6 9 17 4 12" stroke-width="2"></polyline>
                            </svg>
                            Preferences (optional)
                        </label>
                        <div class="flex flex-wrap gap-3">
                            <label class="flex items-center gap-2 cursor-pointer">
                                <input type="checkbox" name="eco_friendly" class="w-5 h-5 text-primary-500 border-gray-300 rounded focus:ring-primary-500">
                                <span class="text-sm font-medium text-gray-700">Eco-friendly</span>
                            </label>
                            <label class="flex items-center gap-2 cursor-pointer">
                                <input type="checkbox" name="fast_shipping" class="w-5 h-5 text-primary-500 border-gray-300 rounded focus:ring-primary-500">
                                <span class="text-sm font-medium text-gray-700">Fast shipping</span>
                            </label>
                            <label class="flex items-center gap-2 cursor-pointer">
                                <input type="checkbox" name="highly_rated" checked class="w-5 h-5 text-primary-500 border-gray-300 rounded focus:ring-primary-500">
                                <span class="text-sm font-medium text-gray-700">Highly rated</span>
                            </label>
                        </div>
                    </div>

                    <!-- Submit Button -->
                    <button 
                        type="submit" 
                        id="submitBtn"
                        class="w-full flex items-center justify-center gap-3 px-6 py-4 bg-gradient-to-r from-primary-500 to-primary-600 text-white font-semibold rounded-xl hover:from-primary-600 hover:to-primary-700 transform hover:-translate-y-0.5 transition-all shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed"
                    >
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="10" stroke-width="2"></circle>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 16v-4"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8h.01"></path>
                        </svg>
                        Get AI Recommendations
                    </button>

                    <!-- Quick Examples -->
                    <div class="pt-6 border-t border-gray-200">
                        <p class="text-sm font-semibold text-gray-600 mb-3">Quick examples to try:</p>
                        <div class="flex flex-wrap gap-2">
                            <button type="button" class="example-btn px-3 py-2 text-xs font-medium bg-gray-100 hover:bg-primary-50 hover:text-primary-600 border border-gray-200 hover:border-primary-300 rounded-lg transition-all" data-query="I need wireless earbuds for workouts, sweat-resistant, good battery life, under â‚¹3000">
                                Workout earbuds
                            </button>
                            <button type="button" class="example-btn px-3 py-2 text-xs font-medium bg-gray-100 hover:bg-primary-50 hover:text-primary-600 border border-gray-200 hover:border-primary-300 rounded-lg transition-all" data-query="Looking for a smartphone under â‚¹20000, good camera, 5G support, long battery life">
                                Budget smartphone
                            </button>
                            <button type="button" class="example-btn px-3 py-2 text-xs font-medium bg-gray-100 hover:bg-primary-50 hover:text-primary-600 border border-gray-200 hover:border-primary-300 rounded-lg transition-all" data-query="Need running shoes for daily jogging, comfortable, good cushioning, budget â‚¹3000-5000">
                                Running shoes
                            </button>
                        </div>
                    </div>
                </form>
            </div>

            <!-- Results Panel -->
            <div class="bg-white rounded-2xl shadow-xl border border-gray-200 p-6 sm:p-8 lg:sticky lg:top-24 h-fit">
                
                <!-- Empty State -->
                <div id="emptyState" class="flex flex-col items-center justify-center py-16 text-center">
                    <div class="w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-6">
                        <svg class="w-12 h-12 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="10" stroke-width="2"></circle>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 16v-4"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8h.01"></path>
                        </svg>
                    </div>
                    <h3 class="text-xl font-bold text-gray-900 mb-2">Ready to find your perfect product?</h3>
                    <p class="text-gray-600 max-w-sm">Describe what you're looking for, and our AI will recommend the best options for you.</p>
                </div>

                <!-- Loading State -->
                <div id="loadingState" class="hidden flex flex-col items-center justify-center py-16">
                    <div class="w-16 h-16 border-4 border-gray-200 border-t-primary-500 rounded-full animate-spin mb-6"></div>
                    <p class="text-lg font-semibold text-gray-900 mb-6">AI is analyzing your preferences...</p>
                    <div class="w-full max-w-sm space-y-3">
                        <div id="step1" class="px-4 py-3 bg-primary-500 text-white rounded-lg text-sm font-medium transition-all">
                            Understanding your needs
                        </div>
                        <div id="step2" class="px-4 py-3 bg-gray-100 text-gray-600 rounded-lg text-sm font-medium transition-all">
                            Finding perfect matches
                        </div>
                        <div id="step3" class="px-4 py-3 bg-gray-100 text-gray-600 rounded-lg text-sm font-medium transition-all">
                            Ranking by relevance
                        </div>
                    </div>
                </div>

                <!-- Results -->
                <div id="resultsContainer" class="hidden">
                    <div class="flex justify-between items-start mb-6 pb-6 border-b-2 border-gray-200">
                        <h3 class="text-2xl font-bold text-gray-900">AI Recommendations</h3>
                        <div class="flex items-center gap-2 px-3 py-1.5 bg-green-50 border border-green-200 rounded-lg">
                            <svg class="w-4 h-4 text-green-600 fill-current" viewBox="0 0 24 24">
                                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
                            </svg>
                            <span class="text-xs font-semibold text-green-700">High Match</span>
                        </div>
                    </div>

                    <div id="recommendationsList" class="space-y-4 mb-6">
                        <!-- Products will be inserted here -->
                    </div>

                    <div class="p-6 bg-gradient-to-br from-primary-50 to-primary-100/50 border border-primary-200 rounded-xl">
                        <h4 class="flex items-center gap-2 font-bold text-gray-900 mb-3">
                            <svg class="w-5 h-5 text-primary-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <circle cx="12" cy="12" r="10" stroke-width="2"></circle>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 16v-4"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8h.01"></path>
                            </svg>
                            AI Analysis
                        </h4>
                        <p id="aiInsights" class="text-gray-700 leading-relaxed"></p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- How It Works -->
    <section class="bg-white py-16 mt-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl font-bold text-center text-gray-900 mb-12">How It Works</h2>
            <div class="grid md:grid-cols-3 gap-8">
                <!-- Step 1 -->
                <div class="text-center group hover:transform hover:-translate-y-2 transition-all">
                    <div class="relative mb-6">
                        <div class="text-7xl font-bold text-gray-100 absolute -top-4 left-1/2 transform -translate-x-1/2">01</div>
                        <div class="relative w-16 h-16 mx-auto bg-gradient-to-br from-primary-500 to-primary-600 rounded-2xl flex items-center justify-center transform group-hover:scale-110 transition-transform">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                            </svg>
                        </div>
                    </div>
                    <h3 class="text-xl font-bold text-gray-900 mb-3">Describe Your Needs</h3>
                    <p class="text-gray-600 leading-relaxed">Tell us what you're looking for in natural language - no need for specific keywords</p>
                </div>

                <!-- Step 2 -->
                <div class="text-center group hover:transform hover:-translate-y-2 transition-all">
                    <div class="relative mb-6">
                        <div class="text-7xl font-bold text-gray-100 absolute -top-4 left-1/2 transform -translate-x-1/2">02</div>
                        <div class="relative w-16 h-16 mx-auto bg-gradient-to-br from-primary-500 to-primary-600 rounded-2xl flex items-center justify-center transform group-hover:scale-110 transition-transform">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <rect x="2" y="3" width="20" height="14" rx="2" ry="2" stroke-width="2"></rect>
                                <line x1="8" y1="21" x2="16" y2="21" stroke-width="2"></line>
                                <line x1="12" y1="17" x2="12" y2="21" stroke-width="2"></line>
                            </svg>
                        </div>
                    </div>
                    <h3 class="text-xl font-bold text-gray-900 mb-3">AI Analysis</h3>
                    <p class="text-gray-600 leading-relaxed">Our AI understands your preferences, budget, and requirements to find perfect matches</p>
                </div>

                <!-- Step 3 -->
                <div class="text-center group hover:transform hover:-translate-y-2 transition-all">
                    <div class="relative mb-6">
                        <div class="text-7xl font-bold text-gray-100 absolute -top-4 left-1/2 transform -translate-x-1/2">03</div>
                        <div class="relative w-16 h-16 mx-auto bg-gradient-to-br from-primary-500 to-primary-600 rounded-2xl flex items-center justify-center transform group-hover:scale-110 transition-transform">
                            <svg class="w-8 h-8 text-white fill-current" viewBox="0 0 24 24">
                                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
                            </svg>
                        </div>
                    </div>
                    <h3 class="text-xl font-bold text-gray-900 mb-3">Personalized Results</h3>
                    <p class="text-gray-600 leading-relaxed">Get ranked recommendations with detailed explanations of why each product fits your needs</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-900 text-gray-300 py-12 mt-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid md:grid-cols-3 gap-8 mb-8">
                <div>
                    <p class="font-bold text-white mb-2">ShopSmart AI</p>
                    <p class="text-sm">Portfolio Project by Jayant Raj Mohan</p>
                    <p class="text-sm">AI Product Manager | GenAI Solutions</p>
                </div>
                <div>
                    <p class="font-semibold text-white mb-3">Links</p>
                    <div class="space-y-2 text-sm">
                        <a href="https://linkedin.com/in/jayantrajmohan" target="_blank" class="block hover:text-primary-400 transition-colors">LinkedIn</a>
                        <a href="mailto:jayantrajmohan@gmail.com" class="block hover:text-primary-400 transition-colors">Contact</a>
                        <a href="../index.html" class="block hover:text-primary-400 transition-colors">Back to Portfolio</a>
                    </div>
                </div>
                <div>
                    <p class="font-semibold text-white mb-3">About This Demo</p>
                    <div class="flex items-start gap-2 p-4 bg-gray-800 rounded-lg border border-gray-700">
                        <svg class="w-5 h-5 text-blue-400 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="10" stroke-width="2"></circle>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 16v-4"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8h.01"></path>
                        </svg>
                        <p class="text-xs">This is a portfolio demonstration using curated mock data to showcase the AI recommendation concept. In production, this would connect to real product databases and live AI processing.</p>
                    </div>
                </div>
            </div>
            <div class="pt-8 border-t border-gray-800 text-center text-sm text-gray-500">
                <p>&copy; 2026 Jayant Raj Mohan. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        // Configuration
        // For production deployment (Vercel/Netlify):
        // - API key is stored securely in environment variables
        // - Requests go through /api/recommend serverless function
        // For local testing with real AI:
        // - Uncomment line below and add your API key
        // - const OPENAI_API_KEY = 'sk-proj-YOUR-KEY-HERE';

        // Toggle between demo mode and live AI mode
        // Set to true when deployed to Vercel with environment variable configured
        const USE_REAL_AI = true; // Live AI mode enabled for production

        // DOM Elements
        const form = document.getElementById('recommendationForm');
        const submitBtn = document.getElementById('submitBtn');
        const queryInput = document.getElementById('productQuery');
        const categorySelect = document.getElementById('category');
        const budgetSelect = document.getElementById('budget');
        const emptyState = document.getElementById('emptyState');
        const loadingState = document.getElementById('loadingState');
        const resultsContainer = document.getElementById('resultsContainer');
        const recommendationsList = document.getElementById('recommendationsList');
        const aiInsights = document.getElementById('aiInsights');

        // Example buttons
        document.querySelectorAll('.example-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                queryInput.value = this.dataset.query;
                queryInput.focus();
            });
        });

        // Form submission
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = new FormData(form);
            const query = formData.get('productQuery') || queryInput.value;
            const category = categorySelect.value;
            const budget = budgetSelect.value;
            
            const preferences = {
                ecoFriendly: formData.get('eco_friendly') === 'on',
                fastShipping: formData.get('fast_shipping') === 'on',
                highlyRated: formData.get('highly_rated') === 'on'
            };
            
            await getRecommendations(query, category, budget, preferences);
        });

        // Main recommendation function
        async function getRecommendations(query, category, budget, preferences) {
            showState('loading');
            animateLoadingSteps();

            try {
                let recommendations;
                if (USE_REAL_AI) {
                    recommendations = await getRealAIRecommendations(query, category, budget, preferences);
                } else {
                    recommendations = await getMockRecommendations(query, category, budget, preferences);
                }
                displayRecommendations(recommendations);
            } catch (error) {
                console.error('Error:', error);

                // Provide more specific error messages
                let errorMessage = 'Something went wrong. ';
                if (error.message.includes('API request failed')) {
                    errorMessage += 'Could not connect to AI service. Please check your API key.';
                } else if (error.message.includes('JSON')) {
                    errorMessage += 'Received invalid response. Please try again.';
                } else {
                    errorMessage += 'Please try again or check the console for details.';
                }

                alert(errorMessage);
                showState('empty');
            }
        }

        // Real AI using serverless function (Vercel/Netlify)
        async function getRealAIRecommendations(query, category, budget, preferences) {
            try {
                // Call our serverless API route instead of OpenAI directly
                // This keeps the API key secure on the server
                const response = await fetch('/api/recommend', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        query,
                        category,
                        budget,
                        preferences
                    })
                });

                if (!response.ok) {
                    const error = await response.json().catch(() => ({}));
                    throw new Error(error.error || `API request failed: ${response.status}`);
                }

                const recommendations = await response.json();
                return recommendations;

            } catch (error) {
                console.error('API Error:', error);
                throw error;
            }
        }

        // Mock AI for demo
        function getMockRecommendations(query, category, budget, preferences) {
            return new Promise((resolve) => {
                setTimeout(() => {
                    // Generate dynamic insights based on actual user input
                    let insights = `Based on your search for "${query.substring(0, 50)}${query.length > 50 ? '...' : ''}", I've analyzed `;

                    const budgetNames = {
                        budget: 'budget-friendly',
                        mid: 'mid-range',
                        premium: 'premium',
                        luxury: 'luxury'
                    };

                    insights += `${category} products in the ${budgetNames[budget]} category. `;

                    if (preferences.highlyRated) {
                        insights += 'All recommendations have excellent customer ratings. ';
                    }
                    if (preferences.ecoFriendly) {
                        insights += 'I prioritized sustainable and eco-conscious options. ';
                    }
                    if (preferences.fastShipping) {
                        insights += 'These products typically offer quick delivery. ';
                    }

                    insights += 'Each option balances quality, value, and your specific needs.';

                    const mockData = {
                        insights: insights,
                        products: generateMockProducts(query, category, budget)
                    };
                    resolve(mockData);
                }, 2500);
            });
        }

        function generateMockProducts(query, category, budget) {
            const products = {
                electronics: [
                    {
                        name: 'boAt Airdopes 131 TWS Earbuds',
                        image: 'ðŸŽ§',
                        description: 'True wireless earbuds with 60H playback, ENxâ„¢ Tech, ASAPâ„¢ Charge, IWPâ„¢ Technology. IPX4 water resistance for workouts.',
                        matchReason: 'Best-selling budget TWS in India with great battery life',
                        brand: {
                            name: 'boAt',
                            storeUrl: 'https://www.boat-lifestyle.com/products/airdopes-131',
                            price: 'â‚¹1,299',
                            inStock: true,
                            shipping: 'Free delivery',
                            warranty: '1 year warranty'
                        }
                    },
                    {
                        name: 'OnePlus Nord CE 3 Lite 5G',
                        image: 'ðŸ“±',
                        description: '8GB RAM, 128GB Storage, Snapdragon 695, 108MP Camera, 5000mAh battery with 67W SUPERVOOC charging.',
                        matchReason: 'Popular mid-range 5G phone with excellent camera',
                        brand: {
                            name: 'OnePlus',
                            storeUrl: 'https://www.oneplus.in/nord-ce-3-lite-5g',
                            price: 'â‚¹19,999',
                            inStock: true,
                            shipping: 'Free delivery',
                            warranty: '1 year manufacturer warranty'
                        }
                    },
                    {
                        name: 'Noise ColorFit Pro 4 Alpha Smartwatch',
                        image: 'âŒš',
                        description: '1.78" AMOLED Display, Bluetooth Calling, 100+ Sports Modes, Heart Rate & SpO2 Monitoring, 7 Days Battery.',
                        matchReason: 'Top-rated Indian smartwatch brand with premium features',
                        brand: {
                            name: 'Noise',
                            storeUrl: 'https://www.gonoise.com/products/colorfit-pro-4-alpha',
                            price: 'â‚¹2,499',
                            inStock: true,
                            shipping: 'Free delivery',
                            warranty: '1 year warranty'
                        }
                    }
                ],
                fashion: [
                    {
                        name: 'Nike Air Max SC Running Shoes',
                        image: 'ðŸ‘Ÿ',
                        description: 'Lightweight cushioning with Max Air unit. Durable leather and textile upper. Perfect for daily wear and light workouts.',
                        matchReason: 'Iconic Nike comfort at accessible price point',
                        brand: {
                            name: 'Nike',
                            storeUrl: 'https://www.nike.com/in/t/air-max-sc-shoes',
                            price: 'â‚¹6,495',
                            inStock: true,
                            shipping: 'Free delivery',
                            warranty: '2 year warranty'
                        }
                    },
                    {
                        name: 'Levi\'s 511 Slim Fit Jeans',
                        image: 'ðŸ‘–',
                        description: 'Classic slim fit with stretch denim. Mid-rise, sits below waist. Versatile for casual and smart-casual wear.',
                        matchReason: 'Timeless Levi\'s quality with modern fit',
                        brand: {
                            name: 'Levi\'s',
                            storeUrl: 'https://www.levi.in/511-slim-fit-jeans',
                            price: 'â‚¹2,999',
                            inStock: true,
                            shipping: 'Free delivery',
                            warranty: 'Lifetime warranty'
                        }
                    },
                    {
                        name: 'Adidas Essentials Solid T-Shirt',
                        image: 'ðŸ‘•',
                        description: 'Regular fit cotton tee with iconic 3-Stripes. Soft, comfortable fabric. Available in multiple colors.',
                        matchReason: 'Affordable Adidas quality for everyday wear',
                        brand: {
                            name: 'Adidas',
                            storeUrl: 'https://www.adidas.co.in/essentials-solid-tee',
                            price: 'â‚¹999',
                            inStock: true,
                            shipping: 'Free delivery on orders above â‚¹799',
                            warranty: '30 day returns'
                        }
                    }
                ],
                home: [
                    {
                        name: 'Prestige IRIS 750W Mixer Grinder',
                        image: 'ðŸ²',
                        description: '3 Stainless Steel Jars, Powerful 750W Motor, Sturdy ABS Body, 2-Year Warranty. Perfect for Indian kitchen.',
                        matchReason: 'Trusted Indian brand with excellent grinding power',
                        brand: {
                            name: 'Amazon.in',
                            storeUrl: 'https://www.amazon.in/Prestige-750-Watt-Mixer-Grinder/dp/B00H9DM45G',
                            price: 'â‚¹3,199',
                            inStock: true,
                            shipping: 'Free delivery',
                            warranty: '2 year warranty'
                        }
                    },
                    {
                        name: 'Philips Daily Collection Air Fryer',
                        image: 'â˜•',
                        description: '4.1L capacity, Rapid Air Technology, Fat removal, Digital display with preset menus. Dishwasher safe parts.',
                        matchReason: 'Popular air fryer for healthy Indian cooking',
                        brand: {
                            name: 'Philips',
                            storeUrl: 'https://www.philips.co.in/c-p/HD9252_90/daily-collection-airfryer',
                            price: 'â‚¹8,499',
                            inStock: true,
                            shipping: 'Free delivery',
                            warranty: '2 year warranty'
                        }
                    },
                    {
                        name: 'Wipro 9W B22 LED Smart Bulb',
                        image: 'ðŸ’¡',
                        description: 'WiFi enabled, 16 million colors, Works with Alexa & Google Home, App control, Voice control, Schedule & timer.',
                        matchReason: 'Affordable Indian smart home solution',
                        brand: {
                            name: 'Wipro',
                            storeUrl: 'https://www.wiprolighting.com/smart-lighting/smart-bulb-9w',
                            price: 'â‚¹599',
                            inStock: true,
                            shipping: 'Free delivery',
                            warranty: '1 year warranty'
                        }
                    }
                ],
                sports: [
                    {
                        name: 'Nivia Storm Football (Size 5)',
                        image: 'âš½',
                        description: 'PVC Moulded construction, Machine stitched, Suitable for hard ground. Official size and weight.',
                        matchReason: 'Popular Indian sports brand, durable for Indian conditions',
                        brand: {
                            name: 'Nivia',
                            storeUrl: 'https://www.nivia.com/products/storm-football-size-5',
                            price: 'â‚¹499',
                            inStock: true,
                            shipping: 'Free delivery',
                            warranty: '90 day warranty'
                        }
                    },
                    {
                        name: 'Boldfit Gym Shaker Bottle 700ml',
                        image: 'ðŸ¥¤',
                        description: 'BPA Free, Leak-proof, Wire ball mixer, Wide mouth, Measurement markings. Dishwasher safe.',
                        matchReason: 'Top-rated fitness accessory brand in India',
                        brand: {
                            name: 'Boldfit',
                            storeUrl: 'https://www.boldfit.in/products/shaker-bottle-700ml',
                            price: 'â‚¹299',
                            inStock: true,
                            shipping: 'Free delivery',
                            warranty: '30 day returns'
                        }
                    },
                    {
                        name: 'Decathlon Yoga Mat 5mm',
                        image: 'ðŸ§˜',
                        description: 'Anti-skid texture, High density foam, Eco-friendly, With carrying strap. Perfect for home workouts.',
                        matchReason: 'Best-selling affordable yoga mat',
                        brand: {
                            name: 'Decathlon',
                            storeUrl: 'https://www.decathlon.in/p/8492136/yoga-mats/yoga-mat-5mm',
                            price: 'â‚¹699',
                            inStock: true,
                            shipping: 'Free delivery',
                            warranty: '2 year warranty'
                        }
                    }
                ],
                beauty: [
                    {
                        name: 'Lakme 9to5 Primer + Matte Lipstick',
                        image: 'ðŸ’„',
                        description: 'Long-lasting matte finish, Enriched with Vitamin E, Non-drying formula. Multiple shades available.',
                        matchReason: 'India\'s most trusted makeup brand',
                        brand: {
                            name: 'Lakme',
                            storeUrl: 'https://www.lakmeindia.com/9to5-primer-matte-lipstick',
                            price: 'â‚¹425',
                            inStock: true,
                            shipping: 'Free delivery',
                            warranty: '100% authentic guarantee'
                        }
                    },
                    {
                        name: 'Minimalist 10% Niacinamide Face Serum',
                        image: 'ðŸ§´',
                        description: 'For acne & acne marks, Oil control, Pore tightening, Fragrance-free, Non-comedogenic. Made in India.',
                        matchReason: 'Trending Indian skincare brand with proven results',
                        brand: {
                            name: 'Minimalist',
                            storeUrl: 'https://beminimalist.co/products/niacinamide-10-face-serum',
                            price: 'â‚¹599',
                            inStock: true,
                            shipping: 'Free delivery',
                            warranty: '30 day returns'
                        }
                    },
                    {
                        name: 'Vega VHDH-05 1200W Hair Dryer',
                        image: 'ðŸ’‡',
                        description: '1200W power, 2 heat/speed settings, Cool shot function, Concentrator nozzle. Foldable for travel.',
                        matchReason: 'Affordable professional-quality hair dryer',
                        brand: {
                            name: 'Vega',
                            storeUrl: 'https://www.vega.co.in/hair-dryer-vhdh-05',
                            price: 'â‚¹749',
                            inStock: true,
                            shipping: 'Free delivery',
                            warranty: '2 year warranty'
                        }
                    }
                ],
                books: [
                    {
                        name: 'Amazon Kindle (11th Gen) with 6" Display',
                        image: 'ðŸ“š',
                        description: 'Glare-free display, 16GB storage, Weeks of battery life, Access to millions of books. Made for reading.',
                        matchReason: 'Best e-reader for Indian readers',
                        brand: {
                            name: 'Amazon',
                            storeUrl: 'https://www.amazon.in/dp/B09SWW583J',
                            price: 'â‚¹8,999',
                            inStock: true,
                            shipping: 'Free delivery',
                            warranty: '1 year warranty'
                        }
                    },
                    {
                        name: 'Atomic Habits by James Clear (Paperback)',
                        image: 'ðŸ“–',
                        description: 'Bestselling self-help book on habit formation. Transform your life with tiny changes. #1 Indian bestseller.',
                        matchReason: 'Life-changing book, highly rated in India',
                        brand: {
                            name: 'Amazon.in',
                            storeUrl: 'https://www.amazon.in/dp/1847941834',
                            price: 'â‚¹399',
                            inStock: true,
                            shipping: 'Free delivery',
                            warranty: '7 day returns'
                        }
                    },
                    {
                        name: 'Classmate Pulse 6-Subject Notebook',
                        image: 'ðŸ“',
                        description: '300 pages, Ruled, Superior quality paper, Spiral binding. Perfect for students and professionals.',
                        matchReason: 'Most popular notebook brand in India',
                        brand: {
                            name: 'Amazon.in',
                            storeUrl: 'https://www.amazon.in/dp/B07VWXK9YZ',
                            price: 'â‚¹189',
                            inStock: true,
                            shipping: 'Free delivery',
                            warranty: '30 day returns'
                        }
                    }
                ]
            };

            return products[category] || products.electronics;
        }

        // Display functions
        function showState(state) {
            emptyState.classList.toggle('hidden', state !== 'empty');
            loadingState.classList.toggle('hidden', state !== 'loading');
            resultsContainer.classList.toggle('hidden', state !== 'results');
        }

        function animateLoadingSteps() {
            const stepMessages = USE_REAL_AI
                ? [
                    'Analyzing your query with AI...',
                    'Finding perfect product matches...',
                    'Ranking recommendations...'
                ]
                : [
                    'Understanding your needs',
                    'Finding perfect matches',
                    'Ranking by relevance'
                ];

            const steps = ['step1', 'step2', 'step3'];

            // Update step text
            steps.forEach((stepId, index) => {
                document.getElementById(stepId).textContent = stepMessages[index];
            });

            // Animate steps
            steps.forEach((stepId, index) => {
                setTimeout(() => {
                    steps.forEach(id => {
                        const el = document.getElementById(id);
                        el.classList.remove('bg-primary-500', 'text-white');
                        el.classList.add('bg-gray-100', 'text-gray-600');
                    });
                    const currentStep = document.getElementById(stepId);
                    currentStep.classList.remove('bg-gray-100', 'text-gray-600');
                    currentStep.classList.add('bg-primary-500', 'text-white');
                }, index * 800);
            });
        }

        function displayRecommendations(data) {
            recommendationsList.innerHTML = '';

            data.products.forEach((product, index) => {
                const productCard = document.createElement('div');
                productCard.className = 'bg-gray-50 border border-gray-200 rounded-xl p-5 hover:shadow-lg hover:border-primary-300 transition-all transform hover:-translate-x-1 animate-fade-in-up';
                productCard.style.animationDelay = `${index * 0.1}s`;

                // D2C brand format
                const brand = product.brand;

                // Build D2C brand button
                const brandHTML = brand ? `
                    <div class="mt-4 p-4 bg-white border-2 border-primary-200 rounded-lg hover:border-primary-400 transition-all">
                        <div class="flex items-center justify-between flex-wrap gap-3">
                            <div class="flex-1 min-w-0">
                                <p class="text-xs text-gray-600 mb-1">Available at</p>
                                <p class="text-lg font-bold text-gray-900 truncate">${brand.name} Official Store</p>
                                <p class="text-xs text-green-600 mt-1">${brand.shipping}${brand.warranty ? ' â€¢ ' + brand.warranty : ''}</p>
                            </div>
                            <a href="${brand.storeUrl}" target="_blank" rel="noopener noreferrer"
                               class="px-6 py-3 bg-gradient-to-r from-primary-600 to-primary-700 hover:from-primary-700 hover:to-primary-800 text-white font-bold rounded-lg shadow-md hover:shadow-lg transition-all transform hover:-translate-y-0.5 whitespace-nowrap">
                                Buy Now ${brand.price}
                            </a>
                        </div>
                    </div>
                ` : '';

                productCard.innerHTML = `
                    <div class="flex items-start gap-4 mb-4">
                        <div class="flex-shrink-0">
                            <div class="w-16 h-16 bg-gradient-to-br from-primary-100 to-primary-50 rounded-xl flex items-center justify-center text-4xl">
                                ${product.image || 'ðŸ“¦'}
                            </div>
                        </div>
                        <div class="flex-1 min-w-0">
                            <div class="flex items-center gap-2 mb-2">
                                <div class="flex items-center justify-center w-6 h-6 bg-gradient-to-br from-primary-500 to-primary-600 text-white rounded-full font-bold text-xs">
                                    ${index + 1}
                                </div>
                                <h4 class="text-lg font-bold text-gray-900">${product.name}</h4>
                            </div>
                            <div class="text-2xl font-bold text-primary-600">${brand ? brand.price : 'N/A'}</div>
                        </div>
                    </div>
                    <p class="text-gray-600 text-sm leading-relaxed mb-3">${product.description}</p>
                    <div class="flex items-center gap-2 px-3 py-2 bg-primary-50 border border-primary-200 rounded-lg">
                        <svg class="w-4 h-4 text-primary-600 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <polyline points="20 6 9 17 4 12" stroke-width="2"></polyline>
                        </svg>
                        <span class="text-xs font-semibold text-primary-700">${product.matchReason}</span>
                    </div>
                    ${brandHTML}
                `;

                recommendationsList.appendChild(productCard);
            });

            aiInsights.textContent = data.insights;
            showState('results');

            if (window.innerWidth <= 1024) {
                resultsContainer.scrollIntoView({ behavior: 'smooth' });
            }
        }

        // Update UI based on AI mode
        function updateAIMode() {
            const badge = document.querySelector('header .flex.items-center.gap-2.px-4.py-2');
            if (USE_REAL_AI) {
                badge.className = 'flex items-center gap-2 px-4 py-2 bg-green-50 border border-green-200 rounded-lg';
                badge.innerHTML = `
                    <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
                    <span class="text-sm font-medium text-green-700">Live AI Mode</span>
                `;
                console.log('%câœ… Live AI Mode Enabled', 'font-size: 16px; font-weight: bold; color: #10b981;');
                console.log('%cUsing OpenAI GPT-4o-mini for real product recommendations', 'font-size: 14px;');
            } else {
                console.log('%cðŸ¤– Demo Mode Active', 'font-size: 16px; font-weight: bold; color: #6366f1;');
                console.log('%cThis demo uses curated mock data. To enable real AI:', 'font-size: 14px;');
                console.log('%c1. Get an OpenAI API key from: https://platform.openai.com/api-keys', 'font-size: 12px; color: #6b7280;');
                console.log('%c2. Add your API key to the OPENAI_API_KEY variable (line 378)', 'font-size: 12px; color: #6b7280;');
                console.log('%c3. Refresh the page - it will automatically detect and use the API', 'font-size: 12px; color: #6b7280;');
            }
        }

        // Initialize on page load
        updateAIMode();
    </script>
</body>
</html>
